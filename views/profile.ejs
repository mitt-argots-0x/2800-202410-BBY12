<%- include("templates/header") %>

    <style>
        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }

        .dark-mode .bg-teal-100 {
            background-color: #1d1d1d;
        }

        .dark-mode .bg-teal-200 {
            background-color: #1d1d1d;
        }

        .dark-mode .border-teal-300 {
            border-color: #ffab40;
        }

        .dark-mode .bg-cyan-200 {
            background-color: #673ab7;
        }

        .dark-mode .hover\:bg-cyan-200:hover {
            background-color: #9575cd;
        }

        /* Dark mode toggle button styles */
        #darkModeToggle {
            background-color: #4a5568;
            color: #ffffff;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #darkModeToggle:hover {
            background-color: #2d3748;
        }
    </style>

    <div class="flex justify-center h-2/3 w-full mt-4 h-5/6">
        <div class="grid justify-center w-1/3 mx-auto">
            <div class="relative">
                <img class="w-2/3 aspect-square mx-auto rounded-full border-4 border-teal-300 mb-2" <% if (typeof(imgSrc) !='undefined' ){
                %>src="<%= imgSrc %>" <% } %> alt="profile image" />
                <i onclick="changeProfilePic()" class="text-xl absolute fa-solid fa-pencil right-0 bg-teal-200 p-2 rounded-full border-2 border-teal-300"></i>
                <h2 class="mt-12 text-center text-2xl"><span class="border-b-4 border-teal-300">
                    <%= user %>
                </span></h2>
            </div>

                    <form class="flex" id="chooseProfilepic"action="/picUpload?email=<%= email %>" method="post" enctype="multipart/form-data">
                        <input class="hidden" type="file" id="image" name="image" required/>
                        <label class="h-3/4 ml-2 my-2 border-2 border-teal-300 bg-teal-200 rounded-3xl px-2 hover:border-cyan-300 hover:bg-cyan-200 text-center" for="image">Select a picture</label>
                        <button class="h-3/4 ml-2 my-2 border-2 border-teal-300 bg-teal-200 rounded-3xl px-2 hover:border-cyan-300 hover:bg-cyan-200">Save New Profile Picture</button>
                    </form>

                    <button
                        class="h-3/4 ml-2 my-2 border-2 border-teal-300 bg-teal-200 rounded-3xl px-2 hover:border-cyan-300 hover:bg-cyan-200"
                        id="setting" onclick='window.location.href="/setting"'><i class="fa-solid fa-cog"></i>Settings</button>
                    <button
                        class="h-3/4 ml-2 my-2 border-2 border-teal-300 bg-teal-200 rounded-3xl px-2 hover:border-cyan-300 hover:bg-cyan-200"
                        id="setting" onclick='window.location.href="/about_us"'><i class="fa-solid fa-circle-info"></i>About Us</button>
                       
                    <button id="darkModeToggle" class="rounded-3xl my-2">Dark Mode</button>
        </div>

        <div class="bg-teal-100 grid h-1/2 rounded-3xl justify-center w-1/2 mx-auto overflow-y-scroll" style="max-height: 80vh;">
            <div id="plannedLocations_goes_here"></div>
            <button
                class="h-3/4 mx-2 my-2 border-2 border-teal-300 bg-teal-200 rounded-t-3xl px-2 hover:border-cyan-300 hover:bg-cyan-200"
                id="savedLocationsBtn">Saved Locations</button>
            <div id="savedLocations_goes_here">
                <div class="container mx-auto p-4">
                    <% if (data.length> 0) { %>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <% data.forEach(day=> { %>
                                <% var bookmark=true; %>
                                    <div class="card bg-white shadow-md rounded-lg p-4">
                                        <button id="saveBtn" onclick="unsaveLocation('<%= day.name %>')"
                                            class="w-1/6"><i class="fa-solid fa-bookmark"></i></button>
                                        <h2 onclick="window.location.href='/destination?location=<%= day.name %>&&bookmark=<% bookmark %>'"
                                            class="text-xl font-semibold"><strong>City:</strong>
                                            <%= day.name %>
                                        </h2>
                                        <% if (day.imageUrl) { %>
                                            <img onclick="window.location.href='/destination?location=<%= day.name %>&&bookmark=<% bookmark %>'" src="<%= day.imageUrl %>" alt="Image of <%= day.city %>"
                                                class="w-full h-48 object-cover rounded mt-4">
                                            <% } %>
                                    </div>
                                    <% }) %>
                        </div>
                        <% } else { %>
                            <p>No data found for the selected criteria.</p>
                            <% } %>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('chooseProfilepic').style.display = 'none';
        function changeProfilePic() {
            if (document.getElementById('chooseProfilepic').style.display == 'grid')
                document.getElementById('chooseProfilepic').style.display = 'none';
            else{
                document.getElementById('chooseProfilepic').style.display = 'grid';
            }
        }
        document.addEventListener('DOMContentLoaded', (event) => {
            const darkModeToggle = document.getElementById('darkModeToggle');

            darkModeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    darkModeToggle.textContent = 'Light Mode';
                } else {
                    darkModeToggle.textContent = 'Dark Mode';
                }
            });
        });

        function unsaveLocation(location) {
            window.location.href = '/unsaveLocation?location=' + location;
        }
    </script>

    <%- include("templates/homenav") %>
        <%- include("templates/footer", { jsFile: ['js/profile.js'] }) %>