<%- include("templates/header") %>

    <div class="grid w-5/6 h-full mx-auto mt-4">
        <img src="<%= location.imageUrl %>" alt="location image"
            class="max-h-72 w-full max border-2 border-orange-400 rounded-3xl">
        <p id="name_goes_here" class="text-center h1">
            <span class="border-b-4 border-purple-600">
                <%= location.city %>
            </span>
        </p>
        <% if (location && location.data && location.data.length> 0) { %>
            <h1 class="text-center text-2xl font-bold mb-4">
                <%= location.city %>
            </h1>
            <table class="table-auto w-full border-collapse border border-gray-200">
                <thead>
                    <tr>
                        <th class="border border-gray-200 px-4 py-2">Date</th>
                        <th class="border border-gray-200 px-4 py-2">Temperature (°C)</th>
                        <th class="border border-gray-200 px-4 py-2">Max Temp (°C)</th>
                        <th class="border border-gray-200 px-4 py-2">Min Temp (°C)</th>
                        <th class="border border-gray-200 px-4 py-2">Conditions</th>
                        <th class="border border-gray-200 px-4 py-2">Humidity (%)</th>
                    </tr>
                </thead>
                <tbody>
                    <% location.data.forEach(day=> { %>
                        <tr>
                            <td class="border border-gray-200 px-4 py-2">
                                <%= day.datetime %>
                            </td>
                            <td class="border border-gray-200 px-4 py-2">
                                <%= day.temp %>
                            </td>
                            <td class="border border-gray-200 px-4 py-2">
                                <%= day.tempmax %>
                            </td>
                            <td class="border border-gray-200 px-4 py-2">
                                <%= day.tempmin %>
                            </td>
                            <td class="border border-gray-200 px-4 py-2">
                                <%= day.conditions %>
                            </td>
                            <td class="border border-gray-200 px-4 py-2">
                                <%= day.humidity %>
                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>
            <% } else { %>
                <p class="text-center">No weather data found for the selected city and date range.</p>
                <% } %>
                    <div class="mx-auto flex justify-center w-4/5 mt-2">
                        <span style="margin-right: 16px;">Rating:<%= location.rating %>
                                <% var fullStars=Math.floor(location.rating); var halfStars=location.rating % 1>= 0.5 ?
                                    1 : 0;
                                    var emptyStars = 5 - fullStars - halfStars;
                                    %>
                                    <% for (var i=0; i < fullStars; i++) { %>
                                        <i style="margin-right: -6px;" class="fa-solid fa-star"></i>
                                        <% } %>
                                            <% if (halfStars) { %>
                                                <i style="margin-right: -6px;" class="fa-solid fa-star-half-stroke"></i>
                                                <% } %>
                                                    <% for (var i=0; i < emptyStars; i++) { %>
                                                        <i style="margin-right: -6px;" class="fa-regular fa-star"></i>
                                                        <% } %>
                        </span>
                        <button
                            class="ml-auto text-2xl pb-1 text-white border-2 border-teal-400 bg-teal-300 rounded-lg px-10 hover:border-cyan-300 hover:bg-cyan-200"
                            id="reviewBtn" onclick='window.location.href="/review?location=<%= location.city %>"'>
                            Reviews
                        </button>
                        <button class="ml-4 mr-auto" onclick="saveLocation('<%= location.city %>')">
                            <% if (bookmark) { %>
                                <i class="fa-solid fa-bookmark"></i>
                                <% } else { %>
                                    <i class="fa-regular fa-bookmark"></i>
                                    <% } %>
                        </button>
                    </div>
                    <script>
                        function saveLocation(location) {
                            window.location.href = '/saveLocation?location=' + location + '&email=<%= email %>';
                        }
                    </script>
    </div>
    <%- include("templates/homenav") %>
        <%- include("templates/footer") %>